{"cells":[{"cell_type":"code","execution_count":null,"metadata":{"id":"zwFnJsE6vjf8"},"outputs":[],"source":["import pprint\n","from random import randint\n","import matplotlib.pyplot as plt\n","import numpy as np\n","from scipy import stats\n","import pandas as pd\n","\n","if __name__ == \"__main__\":\n","    ptd1 = pd.read_csv('part_01.csv')\n","    ptd2 = pd.read_csv('part_02.csv')\n","    ptd3 = pd.read_csv('part_03.csv')\n","    ptd4 = pd.read_csv('part_04.csv')\n","    ptd5 = pd.read_csv('part_05.csv')\n","    ptd6 = pd.read_csv('part_06.csv')\n","    ptd7 = pd.read_csv('part_07.csv')\n","    ptd8 = pd.read_csv('part_08.csv')\n","    ptd9 = pd.read_csv('part_09.csv')\n","    ptd10 = pd.read_csv('part_10.csv')\n","    ptd11 = pd.read_csv('part_11.csv')\n","    ptd12 = pd.read_csv('part_12.csv')\n","\n","    ptds = [ptd1, ptd2, ptd3, ptd4, ptd5, ptd6, ptd7, ptd8, ptd9, ptd10, ptd11, ptd12]\n","\n","    # shapes = [ptd1.shape[1], ptd2.shape[1], ptd3.shape[1], ptd4.shape[1], ptd5.shape[1], ptd6.shape[1], ptd7.shape[1], ptd8.shape[1], ptd9.shape[1], ptd10.shape[1], ptd11.shape[1], ptd12.shape[1]]\n","\n","    db1 = pd.concat([ptd1, ptd9], ignore_index=True)\n","    db2 = pd.concat([ptd2, ptd11], ignore_index=True)\n","    db3 = pd.concat([ptd4, ptd7], ignore_index=True)\n","    db4 = pd.concat([ptd5, ptd12], ignore_index=True)\n","    db5 = pd.concat([ptd6, ptd10], ignore_index=True)\n","    db6 = pd.concat([ptd3, ptd8], ignore_index=True)\n","\n","    dbraw = [db1, db2, db3, db4, db5, db6]\n","\n","    db = db1\n","\n"]},{"cell_type":"code","source":["for i in range(1, len(dbraw)):\n","    db = db.merge(dbraw[i], left_on='ID', right_on='ID')\n","\n","db.drop('APP_EMP_TYPE', axis= 1 , inplace= True )\n","\n","db.drop_duplicates()"],"metadata":{"id":"wrCuxS11QnRk","executionInfo":{"status":"error","timestamp":1707224411728,"user_tz":-420,"elapsed":5,"user":{"displayName":"Денис Шестаков","userId":"08767877570559569717"}},"outputId":"6790d681-c62e-49b0-c6a2-04aefc9ff0fa","colab":{"base_uri":"https://localhost:8080/","height":245}},"execution_count":2,"outputs":[{"output_type":"error","ename":"NameError","evalue":"name 'dbraw' is not defined","traceback":["\u001b[0;31m---------------------------------------------------------------------------\u001b[0m","\u001b[0;31mNameError\u001b[0m                                 Traceback (most recent call last)","\u001b[0;32m<ipython-input-2-e595df584036>\u001b[0m in \u001b[0;36m<cell line: 1>\u001b[0;34m()\u001b[0m\n\u001b[0;32m----> 1\u001b[0;31m \u001b[0;32mfor\u001b[0m \u001b[0mi\u001b[0m \u001b[0;32min\u001b[0m \u001b[0mrange\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;36m1\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mlen\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mdbraw\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m      2\u001b[0m     \u001b[0mdb\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mdb\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mmerge\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mdbraw\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0mi\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mleft_on\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;34m'ID'\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mright_on\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0;34m'ID'\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m      3\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m      4\u001b[0m \u001b[0mdb\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mdrop\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m'APP_EMP_TYPE'\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0maxis\u001b[0m\u001b[0;34m=\u001b[0m \u001b[0;36m1\u001b[0m \u001b[0;34m,\u001b[0m \u001b[0minplace\u001b[0m\u001b[0;34m=\u001b[0m \u001b[0;32mTrue\u001b[0m \u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m      5\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;31mNameError\u001b[0m: name 'dbraw' is not defined"]}]},{"cell_type":"code","source":["list_sm = list(db.select_dtypes(include = 'object').columns)\n","en_to_rus = {'specialist': 'специалист', 'manager': 'менеджер', 'friend': 'друг', 'mother': 'мать', 'relative': 'близкий ро', 'brother': 'брат', 'sister': 'сестра', 'father': 'отец', 'other': 'дальний ро', 'daughter': 'дочь', 'son': 'сын'}\n","\n","for sln in list_sm:\n","    db[sln].where(db[sln].str.replace(' ','').str.isalpha(), np.nan, inplace=True)\n","    db[sln] = db[sln].str.lower()\n","\n","    db[sln] = db[sln].replace(en_to_rus)\n","\n","    #print(db[sln].unique())\n","\n","print(db['CLNT_TRUST_RELATION'].unique())\n","print(db['APP_MARITAL_STATUS'].unique())\n","print(db['CLNT_JOB_POSITION'].nunique())\n"],"metadata":{"id":"f5H2Wk9VTPEk","executionInfo":{"status":"ok","timestamp":1706098699134,"user_tz":-420,"elapsed":3888,"user":{"displayName":"","userId":""}},"outputId":"60b867a9-af4a-4faa-de21-66e0a5f14edc","colab":{"base_uri":"https://localhost:8080/"}},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["[nan 'мать' 'брат' 'друг' 'сестра' 'дальний ро' 'близкий ро' 'дочь' 'сын'\n"," 'отец' 'муж' 'жена']\n","[nan 'd' 'm' 'v' 't' 'n' 'w' 'c']\n","9716\n"]}]},{"cell_type":"code","source":["db = db.sort_values('ID')"],"metadata":{"id":"CKFgc6N2TPLD"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["print(db.head(10))\n","\n","print(\"Rows: \" + str(db.shape[0]) + \" Cols: \" + str(db.shape[1]))"],"metadata":{"id":"ApwbABF2TZyU","executionInfo":{"status":"ok","timestamp":1706098237368,"user_tz":-420,"elapsed":404,"user":{"displayName":"","userId":""}},"outputId":"43168937-e4c8-4511-cb4b-c17dce1cc639","colab":{"base_uri":"https://localhost:8080/"}},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["            ID  AMOUNT_RUB_ATM_PRC  AMOUNT_RUB_CLO_PRC  AMOUNT_RUB_NAS_PRC  \\\n","236790  146841            1.000000            0.000000            0.000000   \n","196597  146842            0.410691            0.041033            0.000000   \n","243652  146843            0.925140            0.006915            0.000000   \n","22845   146844            1.000000            0.000000            0.000000   \n","195106  146845            1.000000            0.000000            0.000000   \n","339288  146846            0.767778            0.077010            0.008501   \n","222523  146847            0.000000            0.000000            0.000000   \n","33053   146848            0.222794            0.748631            0.000000   \n","199684  146850            0.751444            0.017322            0.000000   \n","37879   146851            0.093474            0.067036            0.000000   \n","\n","        AMOUNT_RUB_SUP_PRC  CNT_TRAN_ATM_TENDENCY1M  CNT_TRAN_ATM_TENDENCY3M  \\\n","236790            0.000000                 0.101695                 0.406780   \n","196597            0.244678                 0.166667                 0.333333   \n","243652            0.000000                 0.133333                 0.366667   \n","22845             0.000000                      NaN                      NaN   \n","195106            0.000000                 0.172414                 0.620690   \n","339288            0.050708                 0.166667                 0.500000   \n","222523            0.000000                      NaN                      NaN   \n","33053             0.000000                      NaN                      NaN   \n","199684            0.002935                 0.045455                 0.272727   \n","37879             0.426053                      NaN                 1.000000   \n","\n","        CNT_TRAN_AUT_TENDENCY1M  CNT_TRAN_AUT_TENDENCY3M  \\\n","236790                      NaN                      NaN   \n","196597                 0.166667                 0.666667   \n","243652                      NaN                      NaN   \n","22845                       NaN                      NaN   \n","195106                      NaN                      NaN   \n","339288                 0.500000                 1.000000   \n","222523                      NaN                      NaN   \n","33053                       NaN                      NaN   \n","199684                 0.333333                 0.333333   \n","37879                       NaN                      NaN   \n","\n","        CNT_TRAN_CLO_TENDENCY1M  ...  LDEAL_TENOR_MAX  LDEAL_TENOR_MIN  \\\n","236790                      NaN  ...              NaN              NaN   \n","196597                      NaN  ...              NaN              NaN   \n","243652                      NaN  ...              NaN              NaN   \n","22845                       NaN  ...              NaN              NaN   \n","195106                      NaN  ...              NaN              NaN   \n","339288                     0.25  ...              NaN              NaN   \n","222523                      NaN  ...              NaN              NaN   \n","33053                      1.00  ...              NaN              NaN   \n","199684                      NaN  ...              NaN              NaN   \n","37879                      0.20  ...              NaN              NaN   \n","\n","        LDEAL_USED_AMT_AVG_YQZ  LDEAL_USED_AMT_AVG_YWZ  LDEAL_YQZ_CHRG  \\\n","236790                     NaN                     NaN             NaN   \n","196597                     NaN                     NaN             NaN   \n","243652                     NaN                     NaN             NaN   \n","22845                      NaN                     NaN             NaN   \n","195106                     NaN                     NaN             NaN   \n","339288                     NaN                     NaN             NaN   \n","222523                     NaN                     NaN             NaN   \n","33053                      NaN                     NaN             NaN   \n","199684                     NaN                     1.0             NaN   \n","37879                      NaN                     NaN             NaN   \n","\n","        LDEAL_YQZ_COM  LDEAL_YQZ_PC  MAX_PCLOSE_DATE  MED_DEBT_PRC_YQZ  \\\n","236790            NaN           NaN              NaN               NaN   \n","196597            NaN           NaN              NaN               NaN   \n","243652            NaN           NaN              NaN               NaN   \n","22845             NaN           NaN              NaN               NaN   \n","195106            NaN           NaN              NaN               NaN   \n","339288            NaN           NaN              NaN               NaN   \n","222523            NaN           NaN              NaN               NaN   \n","33053             NaN           NaN              NaN               NaN   \n","199684            NaN           NaN              NaN               NaN   \n","37879             NaN           NaN              NaN               NaN   \n","\n","        MED_DEBT_PRC_YWZ  \n","236790               NaN  \n","196597               NaN  \n","243652               NaN  \n","22845                NaN  \n","195106               NaN  \n","339288               NaN  \n","222523               NaN  \n","33053                NaN  \n","199684               0.0  \n","37879                NaN  \n","\n","[10 rows x 115 columns]\n","Rows: 355190 Cols: 115\n"]}]}],"metadata":{"colab":{"provenance":[{"file_id":"17wU55nPhhZBv8p6y4OrL6ioZAMkld56F","timestamp":1707228726087},{"file_id":"/v2/external/notebooks/intro.ipynb","timestamp":1706098810537}]},"kernelspec":{"display_name":"Python 3","name":"python3"}},"nbformat":4,"nbformat_minor":0}